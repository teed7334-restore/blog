---
layout: post
title:  "閃電網路"
date:   2018-08-08 08:27:00
categories: 區塊鏈技術
tags: 技術
excerpt: 閃電網路
mathjax: true
---

![/blog/images/202010061556.jpg](/blog/images/202010061556.jpg)

閃電網路最初的設想為中心輻射狀網路，透過暫時鏈下交易用以解決比特幣交易過慢問題

## 什麼是閃電網路
閃電網路的核心概念，就是在交易者雙方之間，建立一個鏈下的支付渠道，只要雙方的渠道一打開，就可以進行無數筆鏈下交易

## 如何建立支付渠道
只要交易的雙方，有進行過一次交易，就可以建立支付渠道，雙方在建立交易時，雙方都會先將一筆BTC打到渠道中，最後這筆交易會再被打到區塊鏈上

好比Alice與Bob建立支付渠道，Alice在渠道中投入1BTC，而Bob也在渠道中投入1BTC，這時渠道當中就有Alice與Bob的2BTC，當Alice要付0.1BTC給Bob時，他們可以更新渠道的分配，Alice從渠道中取得0.9BTC，而Bob從渠道中取得1.1BTC，只要這個渠道是開通的狀態，他們就可以進行無限次交易

而當他們要關閉渠道時，系統也會給於雙方1秒鐘的反應時間，且由渠道替雙方進行支付

如果不好理解的話，我們可以想像成，Alice有支付寶帳號，Bob也有支付寶帳號，當Alice要從支付寶打款給Bob時，Alice需要將現金轉到支付寶去，再由Alice的支付寶帳號打去Bob的支付寶帳號當中

當Alice一開始沒有與Bob建立過渠道之時，區塊鏈會透過演算法，將有與Alice有建立渠道，且也與Bob建立渠道的對象找出來，好比那個對象叫做Peter，那Alice就要透過渠道，將錢先轉給Peter，再由Peter透過渠道，將錢轉給Bob

為了防止Peter可能會把錢拿走而沒有將錢轉給Bob，Alice會先對Bob發送一封訊息，並附上一個隨機加密數字(R)，而Bob在收到隨機加密數字(R)之後，會將Alice的加密數字經過HASH成加密數字(H)之後，回傳給Alice

最後Alice會和Peter說，如果你可以給我加密數字(H)未被加密的數字(R)，我就和你更新渠道中的錢，Peter不知道未被加密的數字(R)，所以Peter會找Bob要未被加密的數字(R)，並且更新渠道中的錢

在上面的案例當中，Peter的身份就比較類似中轉站，中轉站必須於渠道中投入足夠的錢，才足夠因應各方的轉賬需求